---
name: Manual Release

on:
  workflow_dispatch:
    inputs:
      app:
        description: "Application"
        default: ""
        required: true
      channels:
        description: "Channels"
        default: ""
        required: true
      push:
        description: "Push"
        default: "false"
        required: false

env:
  TOKEN: ${{ secrets.TOKEN }}

jobs:
  setup:
    name: Setup
    runs-on: ubuntu-latest
    steps:
      - name: Build client data
        run: |-
          echo what

      - name: Repository Dispatch
        uses: peter-evans/repository-dispatch@v2
        with:
          token: ${{ env.TOKEN }}
          repository: onedr0p/containers
          event-type: release-dispatch
          client-payload: ${{ toJson(matrix.changes) }}

  # dispatch:
  #   name: Dispatch
  #   runs-on: ubuntu-latest
  #   needs:
  #     - setup
  #   strategy:
  #     matrix: ${{ fromJson(needs.setup.outputs.matrix) }}
  #     fail-fast: false
  #   steps:
  #     - name: Repository Dispatch
  #       uses: peter-evans/repository-dispatch@v2
  #       with:
  #         token: ${{ env.TOKEN }}
  #         repository: onedr0p/containers
  #         event-type: release-dispatch
  #         client-payload: ${{ toJson(matrix.changes) }}
